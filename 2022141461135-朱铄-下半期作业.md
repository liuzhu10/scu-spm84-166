*Python 技术管理文档*

**1.目的**

    统一代码风格与工程流程，降低沟通和维护成本

    提升可读性、可测试性、可审计性和安全性

    为代码评审、CI/CD、合规审核提供客观依据

**2.强制规则**



    1.所有源文件必须使用 black --line-length 100 自动格式化，CI 阶段强制执行。

    2.文件统一使用 UTF-8 编码，必要时加 # -*- coding: utf-8 -*-。

    3.文件顶部需添加标准版权与许可证头注释。

    4.命名规范：函数/变量用 snake_case，类用 CapWords，常量用 ALL_CAPS。

    5.单行最大长度不得超过 100 个字符。

    6.导入语句必须分组排序，不允许使用 from x import *。

    7.所有 public 类/函数必须添加 Google 风格的 docstring。

    8.所有公共函数与类方法必须添加完整类型注解。

    9.禁用 print()，必须使用 logging 模块输出日志。

    10.异常捕获必须具体，禁止使用裸 except:。

    11.禁止使用 eval() 和 exec()，敏感信息不得硬编码。

    12.不允许在 for 循环中修改被遍历对象。

    13.except: pass、遗留的 TODO 注释超过两周未解决将触发 CI 错误。

    14.所有合并前代码必须通过 lint、mypy、单元测试、SAST 安全扫描。

    15.主干分支测试覆盖率不得低于 80%。

    16.所有依赖项需使用锁定文件，如 poetry.lock 或 requirements.txt。

    17.所有开发与构建操作必须在虚拟环境中完成。

    18.Git commit 信息需遵循 Conventional Commits。

    19.每个 PR 至少需 1 名 Reviewer 审核通过。

    29.生产部署必须通过 CI/CD 完成，不得手动登录操作。


**3. 推荐规则**

    1. 使用 `@dataclass(slots=True)` 替代传统类结构  
   
    2. 推荐使用 f-string 替代 `%` 或 `str.format()`  
   
    3. 使用 `pathlib.Path` 替代 `os.path`  
   
    4. 外部资源应使用 `with` 语句上下文管理  
   
    5. 循环建议使用 `enumerate()` 而非手动下标计数  
   
    6. 函数体不宜超过 50 行，嵌套层级不超过 3 层  
   
    7.  适当使用内建函数如 `map`、`zip`、`any`、`all` 提高表达力  
   
    8.  默认参数避免使用可变对象，如 `[]`、`{}`  
   
    9.  简单转换操作应使用推导式（如列表推导）  
   
    10. 异常日志应包含上下文信息（但避免记录敏感内容）  
   
    11. 示例代码建议在 docstring 中添加 doctest 测试用例  
   
    12. 配置统一使用 `pyproject.toml`  
   
    13. 项目版本应遵循语义化版本规范（SemVer） 
   
    14. 建议使用 `poetry` 进行包管理  
   
    15. 启用 `pre-commit` 进行提交前自动检查



**4. 允许规则**

    1. 允许使用 Jupyter Notebook 进行探索性分析，但重要代码应迁移至模块中  
   
    2. 在单行简单场景下可以使用 `lambda`，复杂逻辑应写成函数  
    
    3. 合理使用 `functools` / `itertools` / `collections` 等标准库增强模块  
    
    4. 第三方库缺失类型定义时，可用 `# type: ignore` 暂时跳过（需附注释）  
   
    5. 允许在专用文件中定义全局常量（如 `settings.py`）  
   
    6.  函数允许返回多个值，推荐使用 `namedtuple` 或 `dataclass`  
   
    7.  Docstring 格式允许使用 reST / NumPy 风格，但需统一  
   
    8.  测试框架推荐使用 `pytest`，可使用参数化等高级特性  
   
    9.  可用 `functools.lru_cache` 缓存纯函数计算结果  
   
    10. 可在模块中使用 `if __name__ == "__main__"` 做快速测试入口
